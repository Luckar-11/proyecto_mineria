<script>
        document.getElementById('prediccion-form').addEventListener('submit', function(e) {
            e.preventDefault(); 

            // 1. Recolectar los datos
            const datos = {
                temp_aire: parseFloat(document.getElementById('temp_aire').value),
                temp_proceso: parseFloat(document.getElementById('temp_proceso').value),
                velocidad_rotacion: parseInt(document.getElementById('velocidad_rotacion').value),
                torque: parseFloat(document.getElementById('torque').value),
                desgaste_herramienta: parseInt(document.getElementById('desgaste_herramienta').value),
                Type: document.getElementById('Type').value
            };

            const resultadoDiv = document.getElementById('resultado');
            resultadoDiv.style.display = 'block';
            resultadoDiv.className = ''; // Limpiar clases
            resultadoDiv.innerHTML = 'Consultando al Doctor v2.0...'; // Usamos innerHTML

            // 2. Enviar los datos al Backend (FastAPI)
            fetch('http://127.0.0.1:8000/predecir', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(datos),
            })
            .then(response => response.json())
            .then(data => {
                // 3. Mostrar la respuesta (¡NUEVA LÓGICA!)
                if (data.error) {
                    resultadoDiv.innerHTML = `<strong>Error:</strong> ${data.error}`;
                    resultadoDiv.classList.add('falla');
                
                } else if (data.prediccion === 'FALLA PROBABLE') {
                    // Construir el HTML de respuesta de falla
                    let htmlRespuesta = `
                        <strong>Predicción:</strong> ${data.prediccion}<br>
                        <strong>Confianza:</strong> ${data.confianza}<br>
                        <strong>Tipo de Falla Probable:</strong> ${data.tipo_falla_probable}<br>
                        <strong>Recomendación:</strong> ${data.recomendacion}
                    `;
                    resultadoDiv.innerHTML = htmlRespuesta;
                    resultadoDiv.classList.add('falla');

                } else {
                    // Construir el HTML de respuesta normal
                    let htmlRespuesta = `
                        <strong>Predicción:</strong> ${data.prediccion}<br>
                        <strong>Confianza:</strong> ${data.confianza}<br>
                        <strong>Recomendación:</strong> ${data.recomendacion}
                    `;
                    resultadoDiv.innerHTML = htmlRespuesta;
                    resultadoDiv.classList.add('normal');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                resultadoDiv.style.display = 'block';
                resultadoDiv.innerHTML = '<strong>Error:</strong> No se pudo conectar al backend. ¿Está corriendo "uvicorn main:app --reload"?';
                resultadoDiv.classList.add('falla');
            });
        });
    </script>
</body>
</html>